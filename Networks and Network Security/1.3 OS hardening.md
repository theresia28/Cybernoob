# Incident Report: Cybersecurity Breach at YummyRecipesForMe.com

### 1. **Incident Overview**  
A former employee of YummyRecipesForMe.com executed a brute force attack to gain access to the website's web host. The hacker used known default passwords to gain access to the admin panel, embedded malware in the website's source code, and changed the administrative password. This attack led to several customers downloading and running malware after visiting the site.

### 2. **Malicious Activity Details**  
1. The former employee/hacker performed a brute force attack, trying multiple default passwords until they found the correct one.
2. Once logged into the admin panel, the hacker embedded a JavaScript function into the website’s source code that prompted visitors to download a file upon visiting the site.
3. The hacker then changed the administrative password, preventing the website owner from accessing the admin panel.

### 3. **Impact on Customers**  
Several customers reported that when they visited the website, they were prompted to download a file to access free recipes. After running the file, their browsers were redirected to a fake website, greatrecipesforme.com, and their personal computers started running slowly.

### 4. **Investigation and Analysis**  
1. **Sandbox Environment**  
   The cybersecurity team created a sandbox environment to observe the suspicious website behavior.

2. **Network Protocol Analysis**  
   The team used tcpdump, a network protocol analyzer, to monitor the website’s behavior. When the URL for the website was accessed, the following process occurred:
   - The browser initiated a DNS request for yummyrecipesforme.com.
   - The DNS server responded with the correct IP address for the website.
   - The browser made an HTTP request to the server using the provided IP address.
   - The browser then initiated the download of a malicious executable file.
   - A DNS request was made for greatrecipesforme.com.
   - The DNS server responded with the IP address for the fake website.
   - The browser made an HTTP request to this new IP address, redirecting the user to the malicious website.

### 5. **Source Code Review and Malware Analysis**  
1. **Compromised Source Code**  
   A senior analyst examined the website’s source code and found JavaScript that prompted visitors to download the malware.
2. **Malware Behavior**  
   Analysis of the downloaded file revealed that it contained a script redirecting browsers from yummyrecipesforme.com to greatrecipesforme.com.

### 6. **Brute Force Attack Findings**  
The cybersecurity team discovered that the web server was impacted by a brute force attack. The attacker was able to guess the password easily because the admin password was still set to the default one, and there were no security controls in place to prevent brute force attacks.

### 7. **Network Protocols Involved**  
- **DNS (Domain Name System)**: Used to resolve the domain name (yummyrecipesforme.com) into an IP address.
- **HTTP (Hypertext Transfer Protocol)**: Used for the browser to request and receive the website and download the malicious file.
- **TCP (Transmission Control Protocol)**: Ensured the reliable transmission of data during the communication between the browser and the server.

### 8. **Recommendation for Prevention**  
To prevent future brute force attacks, it is recommended to implement the following security actions:
1. **Use Strong Passwords**: Ensure that all admin accounts use strong, unique passwords.
2. **Implement Account Lockout Mechanisms**: Set up account lockout policies after a certain number of failed login attempts to prevent brute force attacks.
3. **Enable Multi-Factor Authentication (MFA)**: Add an additional layer of security to the admin login process.
4. **Regularly Update and Monitor Web Server Configurations**: Conduct regular audits to ensure that security best practices are being followed.


# Security Incident Report: Malicious File Download and Brute Force Attack

### Section 1: **Identify the network protocol involved in the incident**
1. The protocol involved in the incident is the **Hypertext Transfer Protocol (HTTP)**.
2. Since the issue was related to accessing the web server for **yummyrecipesforme.com**, it is clear that requests to web servers for web pages typically involve HTTP.
3. The tcpdump log showed the usage of the HTTP protocol when contacting the server during interactions with the **yummyrecipesforme.com** website.
4. Additionally, the malicious file was observed being transported to the users’ computers over the HTTP protocol at the application layer.
5. The primary goal of this section was to identify the network protocol used in the incident. This was determined by reviewing the scenario, DNS & HTTP logs, and the knowledge of the TCP/IP model:
   - The tcpdump log shows a request being sent to the DNS server to resolve the IP address for **yummyrecipesforme.com**. The DNS server responds with the correct IP address, directing the user to the website.
   - The scenario specifies that the website prompts users to download a file to access free recipes. Both the scenario and the logs indicate that this action occurs over the HTTP protocol, which is part of the application layer of the TCP/IP model.
   - After the user downloads and runs the file, the logs show that the browser sends a new request to the DNS server to retrieve the IP address for the different URL, **greatrecipesforme.com**. The DNS server responds with the IP address, and the user is redirected to the new site over HTTP.

### Section 2: **Document the incident**
1. Several customers contacted the website’s helpdesk, stating that when they visited the site, they were prompted to download and run a file claiming to provide access to new recipes. 
2. These users reported that their personal computers had been operating slowly ever since running the file.
3. The website owner attempted to log into the web server but was locked out of their account.
4. The cybersecurity analyst used a **sandbox environment** to open the website without impacting the company network.
5. The analyst ran tcpdump to capture the network traffic packets produced by interacting with the website.
6. The analyst was prompted to download a file, claiming to offer free recipes, accepted the download, and ran it. The browser then redirected the analyst to a fake website (**greatrecipesforme.com**).
7. The cybersecurity analyst reviewed the tcpdump log and observed:
   - The browser initially requested the IP address for **yummyrecipesforme.com**.
   - After establishing a connection with th

# How to Read the tcpdump Traffic Log

This reading explains how to identify the brute force attack using tcpdump.

### Log Analysis

#### Step 1: DNS Resolution Request


The first section of the DNS & HTTP traffic log shows the source computer (`your.machine.52444`) using port `52444` to send a DNS resolution request to the DNS server (`dns.google.domain`) for the destination URL (`yummyrecipesforme.com`). Then the reply comes back from the DNS server to the source computer with the IP address of the destination URL (`203.0.113.22`).

#### Step 2: Connection Request


The next section shows the source computer sending a connection request (`Flags [S]`) from the source computer (`your.machine.36086`) using port `36086` directly to the destination (`yummyrecipesforme.com.http`). The `.http` suffix is the port number; HTTP is commonly associated with port `80`. The reply shows the destination acknowledging it received the connection request (`Flags [S.]`).

The communication between the source and the intended destination continues for about 2 minutes, according to the timestamps between this block (`14:18`) and the next DNS resolution request (see below for the `14:20` timestamp).

#### TCP Flag Codes
- `Flags [S]` - Connection Start
- `Flags [F]` - Connection Finish
- `Flags [P]` - Data Push
- `Flags [R]` - Connection Reset
- `Flags [.]` - Acknowledgment

#### Step 3: HTTP Request


The log entry with the code `HTTP: GET / HTTP/1.1` shows the browser is requesting data from `yummyrecipesforme.com` with the HTTP `GET` method using HTTP protocol version `1.1`. This could be the download request for the malicious file.

#### Step 4: DNS Resolution for New URL


The traffic is routed from the source computer to the DNS server again using port `52444` (`your.machine.52444 > dns.google.domain`) to make another DNS resolution request. This time, the DNS server routes the traffic to a new IP address (`192.0.2.172`) and its associated URL (`greatrecipesforme.com.http`).

#### Step 5: Connection Request to Fake Website


The traffic now changes, as it is routed between the source computer and the spoofed website (`greatrecipesforme.com`). Notice that the port number (`.56378`) on the source computer has changed when redirected to the new website.


# Log HTTP dan DNS

Log berikut berisi detail tentang permintaan DNS dan komunikasi HTTP antara klien dan server.

## DNS Queries

### Permintaan ke `yummyrecipesforme.com`
```plaintext
14:18:32.192571 IP your.machine.52444 > dns.google.domain: 35084+ A? yummyrecipesforme.com. (24)
14:18:32.204388 IP dns.google.domain > your.machine.52444: 35084 1/0/0 A 203.0.113.22 (40)

14:18:36.786501 IP your.machine.36086 > yummyrecipesforme.com.http: Flags [S], seq 2873951608, win 65495, options [mss 65495,sackOK,TS val 3302576859 ecr 0,nop,wscale 7], length 0
14:18:36.786517 IP yummyrecipesforme.com.http > your.machine.36086: Flags [S.], seq 3984334959, ack 2873951609, win 65483, options [mss 65495,sackOK,TS val 3302576859 ecr 3302576859,nop,wscale 7], length 0
14:18:36.786529 IP your.machine.36086 > yummyrecipesforme.com.http: Flags [P.], seq 1:74, ack 1, win 512, options [nop,nop,TS val 3302576859 ecr 3302576859], length 73: HTTP: GET / HTTP/1.1
14:18:36.786595 IP yummyrecipesforme.com.http > your.machine.36086: Flags [.] ack 74, win 512, options [nop,nop,TS val 3302576859 ecr 3302576859], length 0


14:25:29.576493 IP your.machine.56378 > greatrecipesforme.com.http: Flags [S], seq 1020702883, win 65495, options [mss 65495,sackOK,TS val 3302989649 ecr 0,nop,wscale 7], length 0
14:25:29.576510 IP greatrecipesforme.com.http > your.machine.56378: Flags [S.], seq 1993648018, ack 1020702884, win 65483, options [mss 65495,sackOK,TS val 3302989649 ecr 3302989649,nop,wscale 7], length 0
14:25:29.576524 IP your.machine.56378 > greatrecipesforme.com.http: Flags [P.], seq 1:74, ack 1, win 512, options [nop,nop,TS val 3302989649 ecr 3302989649], length 73: HTTP: GET / HTTP/1.1
14:25:29.576597 IP greatrecipesforme.com.http > your.machine.56378: Flags [.] ack 74, win 512, options [nop,nop,TS val 3302989649 ecr 3302989649], length 0

# Log Jaringan

Berikut adalah log jaringan dengan informasi TCP dan HTTP untuk analisis.

## Detail Log

```plaintext
47	3.144521	198.51.100.23	192.0.2.1	TCP	42584->443 [SYN] Seq=0 Win=5792 Len=120
48	3.195755	192.0.2.1	198.51.100.23	TCP	443->42584 [SYN, ACK] Seq=0 Win=5792 Len=120
49	3.246989	198.51.100.23	192.0.2.1	TCP	42584->443 [ACK] Seq=1 Win=5792 Len=120
50	3.298223	198.51.100.23	192.0.2.1	HTTP	GET /sales.html HTTP/1.1
51	3.349457	192.0.2.1	198.51.100.23	HTTP	HTTP/1.1 200 OK (text/html)
52	3.390692	203.0.113.0	192.0.2.1	TCP	54770->443 [SYN] Seq=0 Win=5792 Len=0
53	3.441926	192.0.2.1	203.0.113.0	TCP	443->54770 [SYN, ACK] Seq=0 Win=5792 Len=120
54	3.49316	203.0.113.0	192.0.2.1	TCP	54770->443 [ACK] Seq=1 Win=5792 Len=0
55	3.544394	198.51.100.14	192.0.2.1	TCP	14785->443 [SYN] Seq=0 Win=5792 Len=120
56	3.599628	192.0.2.1	198.51.100.14	TCP	443->14785 [SYN, ACK] Seq=0 Win=5792 Len=120
57	3.664863	203.0.113.0	192.0.2.1	TCP	54770->443 [SYN] Seq=0 Win=5792 Len=0
58	3.716097	192.0.2.1	203.0.113.0	TCP	443->54770 [RST, ACK] Seq=0 Win=5792 Len=120
59	3.767331	198.51.100.5	192.0.2.1	HTTP	GET /index.html HTTP/1.1
60	3.818565	192.0.2.1	198.51.100.5	HTTP	HTTP/1.1 504 Gateway Timeout
61	3.869799	203.0.113.0	192.0.2.1	TCP	54770->443 [SYN] Seq=0 Win=5792 Len=0
62	3.921033	192.0.2.1	203.0.113.0	TCP	443->54770 [RST, ACK] Seq=0 Win=5792 Len=120
...
118	5.123456	203.0.113.0	192.0.2.1	TCP	54770->443 [SYN] Seq=0 Win=5792 Len=0


